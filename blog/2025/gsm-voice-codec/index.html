<!DOCTYPE html> <html lang="en"> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title> Experimenting with GSM Full Rate and Half Rate Voice Codec | Eugenio Moro </title> <meta name="author" content="Eugenio Moro"> <meta name="description" content="Here's my academic webpage. "> <meta name="keywords" content="jekyll, jekyll-theme, academic-website, portfolio-website"> <link rel="stylesheet" href="/assets/css/bootstrap.min.css?a4b3f509e79c54a512b890d73235ef04"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link defer rel="stylesheet" href="/assets/css/academicons.min.css?f0b7046b84e425c55f3463ac249818f5"> <link defer rel="stylesheet" href="/assets/css/scholar-icons.css?62b2ac103a88034e6882a5be5f3e2772"> <link defer rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons&amp;display=swap"> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-github.css?591dab5a4e56573bf4ef7fd332894c99" media="" id="highlight_theme_light"> <link rel="shortcut icon" href="data:image/svg+xml,&lt;svg%20xmlns=%22http://www.w3.org/2000/svg%22%20viewBox=%220%200%20100%20100%22&gt;&lt;text%20y=%22.9em%22%20font-size=%2290%22&gt;%E2%9A%9B%EF%B8%8F&lt;/text&gt;&lt;/svg&gt;"> <link rel="stylesheet" href="/assets/css/main.css?d41d8cd98f00b204e9800998ecf8427e"> <link rel="canonical" href="https://eugeniomoro.github.io/blog/2025/gsm-voice-codec/"> <script src="/assets/js/theme.js?9a0c749ec5240d9cda97bc72359a72c0"></script> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-native.css?5847e5ed4a4568527aa6cfab446049ca" media="none" id="highlight_theme_dark"> <script>
    initTheme();
  </script> </head> <body class="fixed-top-nav "> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top" role="navigation"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/"> <span class="font-weight-bold">Eugenio</span> Moro </a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">about </a> </li> <li class="nav-item "> <a class="nav-link" href="/news/">news </a> </li> <li class="nav-item active"> <a class="nav-link" href="/blog/">blog </a> </li> <li class="nav-item "> <a class="nav-link" href="/publications/">publications </a> </li> <li class="nav-item "> <a class="nav-link" href="/teaching/">teaching </a> </li> <li class="nav-item "> <a class="nav-link" href="/students/">students </a> </li> <li class="nav-item"> <button id="search-toggle" title="Search" onclick="openSearchModal()"> <span class="nav-link">ctrl k <i class="ti ti-search"></i></span> </button> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="ti ti-sun-moon" id="light-toggle-system"></i> <i class="ti ti-moon-filled" id="light-toggle-dark"></i> <i class="ti ti-sun-filled" id="light-toggle-light"></i> </button> </li> </ul> </div> </div> </nav> <progress id="progress" value="0"> <div class="progress-container"> <span class="progress-bar"></span> </div> </progress> </header> <div class="container mt-5" role="main"> <div class="post"> <header class="post-header"> <h1 class="post-title">Experimenting with GSM Full Rate and Half Rate Voice Codec</h1> <p class="post-meta"> Created on March 22, 2025 </p> <p class="post-tags"> <a href="/blog/2025"> <i class="fa-solid fa-calendar fa-sm"></i> 2025 </a>   ·   <a href="/blog/tag/gsm"> <i class="fa-solid fa-hashtag fa-sm"></i> GSM</a>   <a href="/blog/tag/experiments"> <i class="fa-solid fa-hashtag fa-sm"></i> Experiments</a>   ·   <a href="/blog/category/experiments"> <i class="fa-solid fa-tag fa-sm"></i> experiments</a> </p> </header> <article class="post-content"> <div id="markdown-content"> <p>A few days ago, while teaching how GSM works to my students, I reached the part where I explained GSM voice codecs. I shared how there’s more than one codec—specifically, the Full Rate codec, which operates at around 13 kbps, and the Half Rate codec, which works at roughly 5.5 kbps.</p> <p>As far as I know, the Half Rate codec was (or perhaps I should say <em>is</em>) almost never used. This got me thinking: why? After all, Half Rate theoretically allows the system to support twice the number of calls. It must be because of the quality loss, right?</p> <p>But how bad could the quality really be to outweigh the benefit of doubling the system’s capacity? And if the quality was that poor, why even offer the option in the first place? I decided to dig deeper and test it myself.</p> <p>I started by recording my voice and then went online to look for GSM voice codec software. At first, I wasn’t very hopeful, as it seemed like an obscure task. But to my surprise, it turned out to be easier than I thought.</p> <p><a href="https://www.videolan.org/vlc/" rel="external nofollow noopener" target="_blank">VLC</a> can reproduce GSM-encoded voice (is there anything VLC can’t do?). And <a href="https://ffmpeg.org" rel="external nofollow noopener" target="_blank">FFmpeg</a> comes with built-in GSM encoding and decoding capabilities. This made me wonder: why do these tools support GSM codecs out-of-the-box? Is there a significant need for people to work with GSM voice codecs? Perhaps it’s related to GSM eavesdropping? But let’s not go down that rabbit hole.</p> <p>Back to our task, here’s how you do it. Let’s assume that we have an audio file, call it<code class="language-plaintext highlighter-rouge">voice.wav</code>. You will have to instruct <code class="language-plaintext highlighter-rouge">ffmpeg</code> to downsample it to 4 kHz, downmix the stereo into mono, code it using <code class="language-plaintext highlighter-rouge">gsm</code> and save it in a new file called <code class="language-plaintext highlighter-rouge">voice.gsm</code></p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ffmpeg -i voice.wav -ar 8000 -ac 1 -g gsm voice.gsm
</code></pre></div></div> <p>Then open the file with VLC and there you go, you’re listening to your voice coded with the GSM voice codec. Thanks for your attention, see you at the next post.</p> <p>No, wait a second. I didn’t specify Full Rate/Half Rate. I recorded around 13 seconds of voice, and got a gsm file of around 176 kbytes. That gives me a bitrate of 13.5 kbps. <code class="language-plaintext highlighter-rouge">ffmpeg</code> is using Full Rate! But, as i said, I want to use half rate, i want to experience how bad it is.</p> <p>I searched some more, it seems that <code class="language-plaintext highlighter-rouge">libgsm</code> (the codec library used by <code class="language-plaintext highlighter-rouge">ffmpeg</code>) only supports full rate. I couldn’t use <code class="language-plaintext highlighter-rouge">ffmpeg</code> for this. But then I found <a href="https://osmocom.org/projects/gapk/wiki" rel="external nofollow noopener" target="_blank">GAPK</a>, a collection of GSM codecs packed into a command line tool, part of the awesome Osmocom project. <code class="language-plaintext highlighter-rouge">GAPK</code> supports Half Rate, but we have to install it first. Unfortunately there’s no documentation, but the tool is simple enough that we can figure out how it works while using it.</p> <p>We must start with the dependencies. This has been tested on ubuntu 22.04.</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>sudo apt update
sudo apt install build-essential libtool libtalloc-dev libsctp-dev shtool autoconf automake git-core pkg-config make gcc gnutls-dev python2-minimal libusb-1.0.0-dev libmnl-dev liburing-dev libpcsclite-dev
</code></pre></div></div> <p>Now we need to clone and build <code class="language-plaintext highlighter-rouge">libosmocore</code>:</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>git clone https://gitea.osmocom.org/osmocom/libosmocore.git
cd libosmocore/
autoreconf -i
./configure
make -j $(nproc)
sudo make install
sudo ldconfig -i
cd ..
</code></pre></div></div> <p>Finally we can move to installing <code class="language-plaintext highlighter-rouge">GAPK</code>:</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>git clone https://gitea.osmocom.org/osmocom/gapk
cd gapk/
autoreconf -i
./configure --enable-gsmhr
make -j $(nproc)
sudo make install
sudo ldconfig
</code></pre></div></div> <p>If you get an error that says that some headers were not found during <code class="language-plaintext highlighter-rouge">make</code>, just run <code class="language-plaintext highlighter-rouge">make</code> again. That fixed it for me.</p> <p>Now test if everything went fine with <code class="language-plaintext highlighter-rouge">osmo-gapk -h</code>.</p> <p><code class="language-plaintext highlighter-rouge">GAPK</code> can encode <code class="language-plaintext highlighter-rouge">Raw PCM samples Signed 16 bits little endian</code> into different GSM formats, and viceversa. Unfortunately, there’s approximately a 0% probability that your original voice file is a raw PCM file. So we have to prepare it with <code class="language-plaintext highlighter-rouge">ffmpeg</code> first:</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ffmpeg -i voice.wav -f s16le -acodec pcm_s16le -ar 8000 -ac 1 voice.pcm
</code></pre></div></div> <p>That gives us a <code class="language-plaintext highlighter-rouge">voice.pcm</code> file that can be processed by <code class="language-plaintext highlighter-rouge">GAPK</code>. Let’s encode it using Half Rate:</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>osmo-gapk -i voice.pcm -f rawpcm-s16le -g racal-hr -o voice.hr
</code></pre></div></div> <p><code class="language-plaintext highlighter-rouge">voice.hr</code> is 72.8 kbytes, giving us a bitrate of 5.6 kbps - exactly what we were expecting!</p> <p>Unfortunately VLC can’t reproduce Half Rate files. We have to decode it back into PCM using <code class="language-plaintext highlighter-rouge">GAPK</code>:</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>osmo-gapk -i voice.hr -f racal-hr -g rawpcm-s16le -o voice.hr.pcm
</code></pre></div></div> <p>and then into a VLC-supported format with <code class="language-plaintext highlighter-rouge">ffmpeg</code>:</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ffmpeg -f s16le -ar 8000 -ac 1 -i voice.hr.pcm voice.hr.wav
</code></pre></div></div> <p>Finally we can reproduce <code class="language-plaintext highlighter-rouge">voice.hr.wav</code>, which contains the uncompressed audio of our voice, which was previously encoded using Half Rate.</p> <p>And the quality is… good? Really? At least it is from my macbook’s speakers.</p> <p>All of this didn’t prove my theory, but it was a fun way to spend half an hour!</p> </div> </article> </div> </div> <footer class="fixed-bottom" role="contentinfo"> <div class="container mt-0"> © Copyright 2025 Eugenio Moro. Powered by <a href="https://jekyllrb.com/" target="_blank" rel="external nofollow noopener">Jekyll</a> with <a href="https://github.com/alshedivat/al-folio" rel="external nofollow noopener" target="_blank">al-folio</a> theme. Hosted by myself. Photos from <a href="https://unsplash.com" target="_blank" rel="external nofollow noopener">Unsplash</a> and myself. </div> </footer> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="/assets/js/bootstrap.bundle.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@5.0.0/imagesloaded.pkgd.min.js" integrity="sha256-htrLFfZJ6v5udOG+3kNLINIKh2gvoKqwEhHYfTTMICc=" crossorigin="anonymous"></script> <script defer src="/assets/js/masonry.js?a0db7e5d5c70cc3252b3138b0c91dcaf" type="text/javascript"></script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.1.0/dist/medium-zoom.min.js" integrity="sha256-ZgMyDAIYDYGxbcpJcfUnYwNevG/xi9OHKaR/8GK+jWc=" crossorigin="anonymous"></script> <script defer src="/assets/js/zoom.js?85ddb88934d28b74e78031fd54cf8308"></script> <script src="/assets/js/no_defer.js?2781658a0a2b13ed609542042a859126"></script> <script defer src="/assets/js/common.js?e0514a05c5c95ac1a93a8dfd5249b92e"></script> <script defer src="/assets/js/copy_code.js?12775fdf7f95e901d7119054556e495f" type="text/javascript"></script> <script defer src="/assets/js/jupyter_new_tab.js?d9f17b6adc2311cbabd747f4538bb15f"></script> <script async src="https://d1bxh8uas1mnw7.cloudfront.net/assets/embed.js"></script> <script async src="https://badge.dimensions.ai/badge.js"></script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.js" integrity="sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI=" crossorigin="anonymous"></script> <script src="/assets/js/mathjax-setup.js?a5bb4e6a542c546dd929b24b8b236dfd"></script> <script defer src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6" crossorigin="anonymous"></script> <script defer src="/assets/js/progress-bar.js?2f30e0e6801ea8f5036fa66e1ab0a71a" type="text/javascript"></script> <script src="/assets/js/vanilla-back-to-top.min.js?f40d453793ff4f64e238e420181a1d17"></script> <script>
    addBackToTop();
  </script> <script type="module" src="/assets/js/search/ninja-keys.min.js?a3446f084dcaecc5f75aa1757d087dcf"></script> <ninja-keys hidebreadcrumbs noautoloadmdicons placeholder="Type to start searching"></ninja-keys> <script src="/assets/js/search-setup.js?6c304f7b1992d4b60f7a07956e52f04a"></script> <script src="/assets/js/search-data.js"></script> <script src="/assets/js/shortcut-key.js?6f508d74becd347268a7f822bca7309d"></script> </body> </html>